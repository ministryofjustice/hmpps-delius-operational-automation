 
- name: Set Application (Delius)
  set_fact:
      application: "{{ db_type + '-database' }}"

- name: Get New Password for ASM
  include_tasks: create_random_password.yml

# Allow retries in case of password change storm
- name: Record New ASM Password in Parameter Store
  community.aws.aws_ssm_parameter_store:
      name: "/{{ environment_name }}/{{ application }}/db/oradb_asmsnmp_password"
      value: "{{ new_password }}"
      overwrite_value: changed
      string_type: "SecureString"
      region: "{{ region }}"
  retries: 4
  delay: "{{ 60 | random }}"
  throttle: 1