name: "Oracle: Scheduled Delius Development Database Backup"
on:
  schedule:
    - cron: '30 09 * * 1,2,4,5'
    - cron: '30 06 * * 1'
  push:
    branches:
      - DBA-511
    paths:
      - .github/workflows/oracle-schedule-dev-backup.yml
jobs:
  prepare-workflow-call:
    runs-on: ubuntu-latest
    steps:
      - name: Parse Inputs
        id: parseinputs
        run: |
          echo -n "env_matrix={\"include\":[" >> $GITHUB_OUTPUT
          if [[ "${cron_time}" == '30 09 * * 1,2,4,5' ]]
          then
            echo -n '{"TargetAccount":"delius_core_development_dev","TargetHost":"delius_primarydb","Period":"daily"}' >> $GITHUB_OUTPUT
          #elif [[ "${cron_time}" == '30 06 * * 1' ]]
          #then
          #  echo -n '{"TargetAccount":"delius_core_development_dev","TargetHost":"delius_primarydb","Period":"weekly"},' >> $GITHUB_OUTPUT
          fi
          echo "]}" >> $GITHUB_OUTPUT
      - name: Output
        run: echo $GITHUB_OUTPUT

  # run-workflow_call:
  #   needs: prepare-workflow-call
  #   strategy:
  #     matrix: ${{ fromJson(needs.prepare-workflow-call.outputs.env_matrix) }}
  #     fail-fast: true
  #   uses: 
  #     ministryofjustice/hmpps-delius-operational-automation/.github/workflows/oracle-backup.yml@main
  #   with:
  #     TargetAccount: ${{ matrix.TargetAccount }}
  #     TargetHost: ${{ matrix.TargetHost }}
  #     Period: ${{ matrix.Period }}
  #   secrets: inherit
